{"version":3,"file":"154.4a7913c09e75fc60c1f1.js?v=4a7913c09e75fc60c1f1","mappings":"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","sources":["webpack://@deathbeds/jupyterlab-deck/./lib/tools/layover.js"],"sourcesContent":["import { VDomModel } from '@jupyterlab/apputils';\nimport { JSONExt } from '@lumino/coreutils';\nimport { Widget } from '@lumino/widgets';\nimport { drag } from 'd3-drag';\nimport * as d3 from 'd3-selection';\nimport { CSS, DATA } from '../tokens';\n/** An interactive layer positioner. */\nexport class Layover extends Widget {\n    constructor(options) {\n        super(options);\n        this._d3 = null;\n        this._drag = null;\n        this.render = () => {\n            const boxes = d3\n                .select(this.node)\n                .selectAll(`.${CSS.layoverPart}`)\n                .data(this.model.partData, Layover.getPartKey)\n                .join('div')\n                .classed(CSS.layoverPart, true)\n                .style('left', ({ bounds }) => `${bounds.left}px`)\n                .style('top', ({ bounds }) => `${bounds.top}px`)\n                .style('height', ({ bounds }) => `${bounds.height}px`)\n                .style('width', ({ bounds }) => `${bounds.width}px`)\n                .call(Layover.boxDrag);\n            boxes\n                .selectAll(`.${CSS.layoverPartLabel}`)\n                .data((d, i) => [i])\n                .join('div')\n                .classed(CSS.layoverPartLabel, true)\n                .text((d) => d + 1);\n            boxes\n                .selectAll(`.${CSS.layoverHandle}`)\n                .data(Layover.handleData)\n                .join('div')\n                .attr('class', Layover.getHandleClass)\n                .classed(CSS.layoverHandle, true)\n                .call(Layover.handleDrag.container(this.node));\n            boxes\n                .selectAll(`.${CSS.layoverUnstyle}`)\n                .data(Layover.resetData)\n                .join('button')\n                .classed(CSS.layoverUnstyle, true)\n                .text('â†º')\n                .on('click', Layover.onReset);\n        };\n        this.addClass(CSS.layover);\n        this._model = new Layover.Model();\n        document.body.appendChild(this.node);\n        this.model.stateChanged.connect(this.render, this);\n        window.addEventListener('resize', this.render);\n        document.body.dataset[DATA.layoutMode] = DATA.designing;\n        this.render();\n    }\n    dispose() {\n        /* istanbul ignore if */\n        if (this.isDisposed) {\n            return;\n        }\n        this.model.dispose();\n        const { node } = this;\n        super.dispose();\n        document.body.removeChild(node);\n        window.removeEventListener('resize', this.render);\n        delete document.body.dataset[DATA.layoutMode];\n    }\n    get model() {\n        return this._model;\n    }\n}\n(function (Layover) {\n    class Model extends VDomModel {\n        constructor() {\n            super(...arguments);\n            this._parts = [];\n            this._partDatum = (part) => {\n                const { left, top, width, height } = part.node.getBoundingClientRect();\n                let zoom = parseFloat(window.getComputedStyle(part.node).getPropertyValue('zoom') || '1.0');\n                return {\n                    ...part,\n                    bounds: {\n                        left: left * zoom,\n                        top: top * zoom,\n                        width: width * zoom,\n                        height: height * zoom,\n                    },\n                };\n            };\n        }\n        get partData() {\n            return this._parts.map(this._partDatum);\n        }\n        get parts() {\n            return this._parts;\n        }\n        set parts(parts) {\n            this._parts = parts;\n            this.stateChanged.emit(void 0);\n        }\n    }\n    Layover.Model = Model;\n    function setStyles(d) {\n        const { bounds } = d;\n        const { innerWidth, innerHeight } = window;\n        d.setStyles({\n            ...(d.getStyles() || JSONExt.emptyObject),\n            position: 'fixed',\n            left: `${100 * (bounds.left / innerWidth)}%`,\n            top: `${100 * (bounds.top / innerHeight)}%`,\n            width: `${100 * (bounds.width / innerWidth)}%`,\n            height: `${100 * (bounds.height / innerHeight)}%`,\n        });\n    }\n    function resetData(d) {\n        let style = d.getStyles();\n        return style && style.position === 'fixed' ? [d] : [];\n    }\n    Layover.resetData = resetData;\n    function onReset(event, d) {\n        let styles = d.getStyles() || JSONExt.emptyObject;\n        d.setStyles({\n            ...styles,\n            position: null,\n            left: null,\n            top: null,\n            width: null,\n            height: null,\n        });\n    }\n    Layover.onReset = onReset;\n    function getPartKey(d) {\n        return d.key;\n    }\n    Layover.getPartKey = getPartKey;\n    function getHandleClass(h) {\n        return `${CSS.layoverHandle}-${h.handle}`;\n    }\n    Layover.getHandleClass = getHandleClass;\n    function onBoxDragStart(event, d) {\n        d3.select(this).classed(CSS.dragging, true);\n    }\n    function onBoxDrag(event, d) {\n        d.bounds.left += event.dx;\n        d.bounds.top += event.dy;\n        d3.select(this)\n            .style('left', `${d.bounds.left}px`)\n            .style('top', `${d.bounds.top}px`);\n    }\n    function onBoxDragEnd(event, d) {\n        d3.select(this).classed(CSS.dragging, false);\n        setStyles(d);\n    }\n    Layover.boxDrag = drag()\n        .on('start', onBoxDragStart)\n        .on('drag', onBoxDrag)\n        .on('end', onBoxDragEnd);\n    function onHandleDragStart(event, d) {\n        d3.select(this.parentElement).classed(CSS.dragging, true);\n    }\n    function onHandleDrag(event, d) {\n        let { dx, dy } = event;\n        let { bounds } = d.part;\n        let h = d.handle;\n        if (h.includes('n')) {\n            bounds.top += dy;\n            bounds.height -= dy;\n        }\n        else if (h.includes('s')) {\n            bounds.height += dy;\n        }\n        if (h.includes('w')) {\n            bounds.left += dx;\n            bounds.width -= dx;\n        }\n        else if (h.includes('e')) {\n            bounds.width += dx;\n        }\n        d3.select(this.parentElement)\n            .style('left', `${bounds.left}px`)\n            .style('top', `${bounds.top}px`)\n            .style('height', `${bounds.height}px`)\n            .style('width', `${bounds.width}px`);\n    }\n    function onHandleDragEnd(event, d) {\n        d3.select(this.parentElement).classed(CSS.dragging, false);\n        setStyles(d.part);\n    }\n    Layover.handleDrag = drag()\n        .on('start', onHandleDragStart)\n        .on('drag', onHandleDrag)\n        .on('end', onHandleDragEnd);\n    function handleData(part) {\n        let handleData = [];\n        for (const handle of HANDLES) {\n            handleData.push({ part, handle });\n        }\n        return handleData;\n    }\n    Layover.handleData = handleData;\n    const HANDLES = ['nw', 'n', 'ne', 'w', 'e', 'sw', 's', 'se'];\n})(Layover || (Layover = {}));\n//# sourceMappingURL=layover.js.map"],"names":["Layover","Widget","constructor","options","super","this","_d3","_drag","render","boxes","node","selectAll","layoverPart","data","model","partData","getPartKey","join","classed","style","bounds","left","top","height","width","call","boxDrag","layoverPartLabel","d","i","text","layoverHandle","handleData","attr","getHandleClass","handleDrag","container","layoverUnstyle","resetData","on","onReset","addClass","layover","_model","Model","document","body","appendChild","stateChanged","connect","window","addEventListener","dataset","layoutMode","designing","dispose","isDisposed","removeChild","removeEventListener","VDomModel","arguments","_parts","_partDatum","part","getBoundingClientRect","zoom","parseFloat","getComputedStyle","getPropertyValue","map","parts","emit","setStyles","innerWidth","innerHeight","getStyles","JSONExt","emptyObject","position","event","styles","key","h","handle","drag","dragging","dx","dy","parentElement","includes","HANDLES","push"],"sourceRoot":""}